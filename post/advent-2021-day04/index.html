<!DOCTYPE html>
<html lang="en-us">
<head>
    
        
<meta charset="utf-8">
<meta name="HandheldFriendly" content="True">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="no-referrer-when-downgrade">

<title>Working code is better than clever code (AOC 2021 day 4) - C&#39;est la Z</title>
<meta name="description" content="">

<link rel="icon" type="image/x-icon" href="https://cestlaz.github.io/favicon.ico">
<link rel="apple-touch-icon-precomposed" href="https://cestlaz.github.io/favicon.png">

<link rel="stylesheet" href="https://cestlaz.github.io/css/style.css?rnd=1670014579" />



<meta property="og:title" content="Working code is better than clever code (AOC 2021 day 4)" />
<meta property="og:description" content="I always tell my students that the cleverest program is worthless if it doesn&#39;t actually work.
 There are always some kids in class that all too often try to write the fanciest solutions.
 They&#39;re the ones that write
int l(char *s){return !*s?0:(l(&#43;&#43;s)&#43;1);}   instead of something like:
int string_length(char *s){ int i = 0; while (s[i] != 0){ i=i&#43;1; } return i; }   to calculate the length of a string." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cestlaz.github.io/post/advent-2021-day04/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-12-04T12:17:30-04:00" />
<meta property="article:modified_time" content="2021-12-04T12:17:30-04:00" />


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Working code is better than clever code (AOC 2021 day 4)"/>
<meta name="twitter:description" content="I always tell my students that the cleverest program is worthless if it doesn&#39;t actually work.
 There are always some kids in class that all too often try to write the fanciest solutions.
 They&#39;re the ones that write
int l(char *s){return !*s?0:(l(&#43;&#43;s)&#43;1);}   instead of something like:
int string_length(char *s){ int i = 0; while (s[i] != 0){ i=i&#43;1; } return i; }   to calculate the length of a string."/>








    
</head>
<body>
<script id="dsq-count-scr" src="//cestlaz.disqus.com/count.js" async></script>


  <a class="skip-main" href="#main">Skip to main content</a>
    <div class="container">
        <header> 
            
                <h1 class="site-header">
    <a href="/">C&#39;est la Z</a>
</h1>
<nav>
    
    
    <a class="" href="https://cestlaz.github.io/" title="">Home</a>
    
    <a class="" href="https://cestlaz.github.io/stories/emacs" title="">Emacs</a>
    
    <a class="" href="https://cestlaz.github.io/archive" title="">Archive</a>
    
    <a class="" href="https://cestlaz-nikola.github.io/" title="">Old Blog</a>
    
    <a class="" href="https://cestlaz.github.io/about" title="">About</a>
    
    <a class="" href="https://cestlaz.github.io/rss.xml" title="">RSS</a>
    
</nav>

            
        </header>
        <main id="main" tabindex="-1"> 
            

    <article class="post">
        <header>
            <h1 class="post-title">Working code is better than clever code (AOC 2021 day 4)</h1>
        </header>
        <div class="content">
            <p>
I always tell my students that the cleverest program is
worthless if it doesn&#39;t actually work.</p>
<p>
There are always some kids in class that all too often try to write
the fanciest solutions.</p>
<p>
They&#39;re the ones that write</p>
<div class="src src-c">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">l</span>(<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>s){<span style="color:#66d9ef">return</span> <span style="color:#f92672">!*</span>s<span style="color:#f92672">?</span><span style="color:#ae81ff">0</span><span style="color:#f92672">:</span>(l(<span style="color:#f92672">++</span>s)<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>);}</code></pre></div>
</div>
<p>
instead of something like:</p>
<div class="src src-c">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">string_length</span>(<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>s){
  <span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
  <span style="color:#66d9ef">while</span> (s[i] <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>){
    i<span style="color:#f92672">=</span>i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>;
    }
  <span style="color:#66d9ef">return</span> i;
}</code></pre></div>
</div>
<p>
to calculate the length of a string.</p>
<p>
They try to code in a way they envision a master programmer coding
which invariably leads them to hours of heartache and misery as they
try to fix a poorly and complexly designed system. When I was a kid I
did this as well but learned better early on. One thing I was pretty
proud of as a young professional programmer were the number of
comments I&#39;d get from peers and superiors on the readability of my
work.</p>
<p>
Of course, my view isn&#39;t unique. Much more famously, Donald Knuth said
the same when he quipped that &#34;premature optimization is the root of
all evil.&#34;</p>
<p>
So while today&#39;s advent of code problem presented a number of design
choices, I decided to go lazy and simple. Sure, my solution&#39;s probably
slower than others but it&#39;s easy and understandable.</p>
<p>
Today&#39;s problem had you playing bingo against a giant squid (full
problem <a href="https://adventofcode.com/2021/day/4">here</a>). The core was that after a number of numbers were drawn,
each time you crossing that number off your boards, you had to figure
out if a board was a winner.</p>
<p>
First the input. It was easy enough to read in the file. The first
line were the bingo balls in the order they were to be drawn and then
you had a bunch of 5 line blocks, each line with 5 numbers
representing a 5x5 board. Each board was separated by a space.</p>
<p>
My strategy was to read in all the boards into a list, then as I draw
each bingo ball, replace all occurrences of the number drawn in on the
boards with an X. Then, check to see if we have 5 X&#39;s in a row either
vertically or horizontally.</p>
<p>
Reading was easy but there were some decisions to be made. I was going
to have a list of boards but what should a board look like? I didn&#39;t
want to use a 2D array since that&#39;s not Clojure&#39;s strong suit but I
could easily use a list of lists (or vector of vectors).</p>
<pre class="example">
((22 13 17 11  0)
 ( 8  2 23  4 24)
 (21  9 14 16  7)
 (6 10  3 18  5)
 (1 12 20 15 19))
</pre>
<p>
If I were coding in Python, I could do this as well using a list of lists.</p>
<p>
This representation makes it <strong>very</strong> easy to check to see if we have a winner
going across but checking vertically is a little annoying and doing
the substitutions is also annoying.</p>
<p>
On the other hand, I could represent the board as a list of 25 items
and use a mapping function to get to a specific row,col location such
as <code>index = board[row*5+col]</code> . This representation makes checking the
board for winners a little onerous but marking squares with an X
becomes trivial - just replace all occurrences of the number in
question with an X. This can be done in Clojure using map:</p>
<div class="src src-clojure">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-clojure" data-lang="clojure">(<span style="color:#66d9ef">defn </span>add-mark [board mark]
  (map <span style="color:#f92672">#</span>(<span style="color:#66d9ef">if </span>(= % mark) <span style="color:#e6db74">&#34;X&#34;</span> %) board))</code></pre></div>
</div>
<p>
Thinking about it, it was really easy to switch from the list of 25
items to the list of list representations. We can do this with the
Clojure partition function.</p>
<div class="src src-clojure">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-clojure" data-lang="clojure">    (<span style="color:#a6e22e">partition</span> <span style="color:#ae81ff">5</span> <span style="color:#f92672">&#39;</span>(<span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">5</span> <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">7</span> <span style="color:#ae81ff">8</span> <span style="color:#ae81ff">9</span> <span style="color:#ae81ff">10</span> <span style="color:#ae81ff">11</span> <span style="color:#ae81ff">12</span> <span style="color:#ae81ff">13</span> <span style="color:#ae81ff">14</span> <span style="color:#ae81ff">15</span> <span style="color:#ae81ff">16</span> <span style="color:#ae81ff">17</span> <span style="color:#ae81ff">18</span> <span style="color:#ae81ff">19</span> <span style="color:#ae81ff">20</span> <span style="color:#ae81ff">21</span> <span style="color:#ae81ff">22</span> <span style="color:#ae81ff">24</span> <span style="color:#ae81ff">24</span>))

    <span style="color:#75715e">;; results in:</span>
    <span style="color:#75715e">;;((0 1 2 3 4)</span>
    <span style="color:#75715e">;; (5 6 7 8 9 )</span>
    <span style="color:#75715e">;; (10 11 12 13 14)</span>
    <span style="color:#75715e">;; (15 16 17 18 19)</span>
    <span style="color:#75715e">;; (20 21 22 23 24))</span></code></pre></div>
</div>
<p>
So, we can use the 25 element list representation to mark the boxes
and then switch to the list of lists to check for a winner. What&#39;s
better, we can transpose the list of lists, that is switch the rows
and columns so as to make the vertical check into a horizontal one.</p>
<p>
Here&#39;s my code to do all the checking:</p>
<div class="src src-clojure">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-clojure" data-lang="clojure">(<span style="color:#66d9ef">defn </span>has-five? [board]
  (&gt;  (<span style="color:#a6e22e">-&gt;&gt;</span> board
           (map <span style="color:#f92672">#</span>(filter (<span style="color:#66d9ef">fn </span>[x] (= x <span style="color:#e6db74">&#34;X&#34;</span>))%)  ) <span style="color:#75715e">;; keep only the Xs</span>
           (map count) <span style="color:#75715e">;; how many are there in each row</span>
           (filter <span style="color:#f92672">#</span>(= <span style="color:#ae81ff">5</span> % )) <span style="color:#75715e">;; keep the winners (5 in a row)</span>
           count) <span style="color:#ae81ff">0</span>)) <span style="color:#75715e">;; return true if we have any winners</span>



(<span style="color:#66d9ef">defn </span>check-board [board]
  (<span style="color:#66d9ef">let </span>[horiz (<span style="color:#a6e22e">partition</span> <span style="color:#ae81ff">5</span> board) <span style="color:#75715e">;; convert 1D board to a 2D one</span>
        vert  (apply mapv vector horiz)] <span style="color:#75715e">;; transpose </span>
    (or  (<span style="color:#a6e22e">has-five?</span> horiz)
         (<span style="color:#a6e22e">has-five?</span> vert))))</code></pre></div>
</div>
<p>
Now, solving part 1 was easy:</p>
<ol>
<li>take the next ball</li>
<li>mark all the locations with the ball&#39;s number</li>
<li>see if there&#39;s a winner</li>
<li>If not, go back to step 1.</li>
</ol>
<p>
Sure, we&#39;re doing more transformations on the data than needed but
it&#39;s clean and easy and at least from my point of view, made the whole
exercise much less error prone.</p>
<p>
On to part 2.</p>
<p>
Turns out that was also pretty simple. Instead of stopping at the
first winning board we had to find the last winning board.</p>
<p>
Pretty easy. We just had to modify the above procedure to the
following:</p>
<ol>
<li>take the next ball</li>
<li>mark all the locations wiht the ball&#39;s number</li>
<li>remove any board that&#39;s a winner</li>
<li>If we&#39;re down to one board remaining we&#39;ve found the board</li>
<li>If not, back to step 1</li>
</ol>
<p>I did this but first got a wrong answer. After looking at my results I
realized that I stopped when I got down to 1 board but it hadn&#39;t
necessarily won yet. I had to then continue drawing balls and marking
squares until that final board was solved.</p>
<p>
That was it.</p>
<p>
Upon later reflection, I realized my solution wasn&#39;t perfect. It would
fail if there were some boards that were never solvable. This though
is an easy fix.</p>
<p>
So, maybe not a super clever super fast solution but a clean one that
works and is easy to understand and modify. To me that&#39;s the
definition of a great solution.</p>

        </div>
        


<div class="post-info">
    
        <div class="post-date">2021-12-04</div>
    
    <div class="post-taxonomies">
        
            <ul class="post-categories">
                
                    <li><a href="https://cestlaz.github.io/categories/Programming">Programming</a></li>
                
            </ul>
            
            
                <ul class="post-tags">
                    
                        <li><a href="https://cestlaz.github.io/tags/advent-of-code">#Advent of Code</a></li>
                    
                </ul>
        
    </div>
</div>

    </article>

    

    
        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "cestlaz" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    


        </main>
        <footer>
            
                
                

                <p>© 2022<br>
Powered by <a target="_blank" href="https://gohugo.io/">Hugo</a>, theme <a target="_blank" href="https://github.com/mitrichius/hugo-theme-anubis">Anubis</a>.
</p>
            
        </footer>
    </div>
</body>
</html>
